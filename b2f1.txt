file modified from nmain branch